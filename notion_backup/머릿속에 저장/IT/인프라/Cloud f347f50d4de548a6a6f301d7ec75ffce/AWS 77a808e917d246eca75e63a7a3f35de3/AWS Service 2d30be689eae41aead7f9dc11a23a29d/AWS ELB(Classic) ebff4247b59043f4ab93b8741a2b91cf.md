# AWS ELB(Classic)

---

- 고가의 로드벨런서를 직접 구축하지 않고도, 로드벨런서를 이용할 수 있도록 하는 서비스
- ELB를 사용하게 되면, https로 통신을 열었을시에도 서버의 부하를 줄일 수 있음
    - 보안을 위해서라면, 클라이언트 ↔ ELB간은 https로 통신을 해야하는게 맞음
    - 다만 ELB ↔ 인스턴스 사이에는 이미 AWS가 안전하게 통신할 수 있도록 보안을 설정했기 때문에
    굳이 https로 통신을 이어나가지 않아도 됨.
    - https를 사용하게 되면, 브라우저와 서버간의 암호화/복호화 작업이 일어나게 되는데, http를 사용하면
    그러한 과정이 생략되기 때문에 더욱 리소스를 덜 차지하게 됨

<aside>
💡 인스턴스 세개를 생성한 후 각 서버마다 게시판 war를 실행시켜보면
ELB가 설정한 시간마다 헬스 체크를 하는 것을 확인할 수 있다. 
**Response Timeout** : 요청 후 설정한 시간동안 정상 코드를 받지 못하면 비정상으로 체크
**Health Check Interval** : 설정한 시간마다 한번씩 헬스체크 요청
**Unhealthy threshold** : 비정상 상태가 설정한 횟수 이상으로 체크되면 로드벨런싱에서 제외
      - 로드벨런싱에서 제외되어도 헬스체크는 지속함
**Healthy threshold** : 비정상 인스턴스에게서 설정 횟수 이상으로 정상체크가 되면 
                                   다시 로드벨런싱 대상으로 변경
댓글 생성/게시글 작성등으로 부하를 주게되면 세개의 인스턴스가 나누어 작업함을 확인할 수 있음
// 클라이언트의 접속을 서버로 바로 붙게 하는것이 아니라, ELB를 바라보게 하면 알아서 분배해줌
// 그렇게 되면 굳이 인스턴스에 Elastic IP를 붙히지 않아도 괜찮을 것 같음.

</aside>

![Untitled](AWS%20ELB(Classic)%20ebff4247b59043f4ab93b8741a2b91cf/Untitled.png)

> !! 주의사항
실질적으로 데이터가 저장되는 DB가 포함된 인스턴스는 스케일 아웃을 하면 안됨. (데이터가 분리되어버림)
정적인 데이터(HTML / 미들웨어 등의 정적인 요소)을 return하는 인스턴스를 분리하면 분산 가능
>